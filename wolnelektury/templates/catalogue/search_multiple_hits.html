{% extends "base.html" %}
{% load i18n %}
{% load catalogue_tags pagination_tags %}

{% block title %}{% trans "Searching in" %} WolneLektury.pl{% endblock %}

{% block bodyid %}tagged-object-list{% endblock %}

{% block body %}
    <form action="{% url search %}" method="get" accept-charset="utf-8" id="search-form">
        <p>{{ form.q }} <input type="submit" value="{% trans "Search" %}" /> <strong>{% trans "or" %}</strong> <a href="{% url main_page %}">{% trans "return to main page" %}</a></p>
    </form>

    <div id="results">
      <ol>
      {% for result in results %}
      <li>
	<p><a href="{{result.book.get_absolute_url}}">{{result.book.pretty_title}}</a> (id: {{result.book_id}}, score: {{result.score}})</p>
	<ul>
	  {% for hit in result.hits %}
	  <li>
	    {% for snip in hit.3.snippets %}
	      {{snip|safe}}<br/>
	    {% endfor %}
	  </li>
	  {% endfor %}

	  {% for part in result.parts %}
	  {% if part.header %}
	  <li>W {{part.header}} nr {{part.position}}</li>
	  {% else %} 
	  {% if part.fragment %}
	  <li>
	    <div style="">Tagi/Motywy: {% for tag in part.fragment.tags %}{{tag.name}} {% endfor %}</div>
	    {{part.fragment.short_html|safe}}
	  </li>
	  {% endif %}
	  {% endif %}
	  {% endfor %}
	</ul>
      </li>
      {% empty %}
      <p>No results.</p>
      {% endfor %}
      </ol>
    </div>


{% comment %}
    <div id="books-list">
        <p>{% trans "More than one result matching the criteria found." %}</p>
        <ul class='matches'>
        {% for match, link, type in results %}
          <li>{% trans type %}: <a href='{{ link }}'>
            {% ifequal type "book" %}
                {% book_title match %}
            {% else %}
                {{ match.name }}
            {% endifequal %}
          </a></li>
        {% endfor %}
        </ul>
    </div>
{% endcomment %}

    <div id="set-window">
        <div class="header"><a href="#" class="jqmClose">{% trans "Close" %}</a></div>
        <div class="target">
            <p><img src="{{ STATIC_URL }}img/indicator.gif" alt="*"/> {% trans "Loading" %}</p>
        </div>
    </div>
{% endblock %}
