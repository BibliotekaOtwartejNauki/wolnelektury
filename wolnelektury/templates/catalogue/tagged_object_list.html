{% extends "base.html" %}
{% load catalogue_tags pagination_tags %}

{% block title %}{% title_from_tags tags %} w WolneLektury.pl{% endblock %}

{% block bodyid %}tagged-object-list{% endblock %}

{% block body %}
    <h1>{% title_from_tags tags %}</h1>
    {% breadcrumbs tags %}
    
    {% if shelf_is_set and not object_list %}
    <div id="books-list">
        <h2>Twoja półka jest pusta</h2>
        <p>Możesz wrzucić książkę na półkę, wchodząc na stronę danej lektury i klikając na przycisk „Na półkę!”.</p>
    </div>
    {% else %}
    {% autopaginate object_list 10 %}
    <div id="books-list">
        {% with tags|last as last_tag %}
        {% if last_tag.has_description %}
            <div id="description">
                {{ last_tag.description|safe }}
            </div>
            <div class="clearboth"></div>
            <div id="toggle-description"><p>Zwiń opis ▲</p></div>
        {% endif %}
        {% if shelf_is_set %}
            <a id="download-shelf" href="{% url download_shelf last_tag.slug %}">
                Pobierz wszystkie książki z tej półki
            </a>
            <div id="download-shelf-menu" style="display:none;">
                <form action="{% url download_shelf last_tag.slug %}" method="get" accept-charset="utf-8" id="download-formats-form" data-formats-feed="{% url shelf_book_formats last_tag.slug %}">
                    <p>Wybierz formaty książek, które chcesz pobrać:</p>
                    <li data-format="pdf"><label for="id_formats_2"><input type="checkbox" name="formats" value="pdf" id="id_formats_2" /> PDF</label> <em><strong>do czytania</strong> i drukowania przy pomocy <a href="http://get.adobe.com/reader/">Adobe Reader</a></em></li>
                    <li data-format="odt"><label for="id_formats_3"><input type="checkbox" name="formats" value="odt" id="id_formats_3" /> ODT</label> <em><strong>do czytania</strong> i edytowania przy pomocy <a href="http://pl.openoffice.org/">OpenOffice.org</a></em></li>
                    <li data-format="txt"><label for="id_formats_4"><input type="checkbox" name="formats" value="txt" id="id_formats_4" /> TXT</label> <em><strong>do czytania</strong> na małych ekranach, np. na komórce</em></li>
                    <li data-format="mp3"><label for="id_formats_0"><input type="checkbox" name="formats" value="mp3" id="id_formats_0" /> MP3</label> <em><strong>do słuchania</strong> w ulubionym odtwarzaczu MP3</em></li>
                    <li data-format="ogg"><label for="id_formats_1"><input type="checkbox" name="formats" value="ogg" id="id_formats_1" /> OGG Vorbis</label> <em><strong>do słuchania</strong> &mdash; otwarty format <a href="http://www.vorbis.com/">Fundacji Xiph.Org</a></em></li>
                    <li id="download-formats-form-submit-li"><label><input type="submit" name="submit" value="Pobierz" id="download-formats-form-submit" disabled="disabled" />&nbsp;<img src="/static/img/indicator.gif" /></label> <span id="updating-formats">Uaktualniam listę formatów książek na półce.</span><span id="formats-updated" style="display:none;">lub <a href="#" id="download-formats-form-cancel">anuluj</a></span></li>
                    <div class="clearboth"></div>
                </form>
            </div>
        {% endif %}
        {% if last_tag.gazeta_link %}
        <p><a href="{{ last_tag.gazeta_link }}">
            {% ifequal last_tag.category "author" %}Przeczytaj omówienia utworów autora w serwisie Lektury.Gazeta.pl{% endifequal %}
            {% ifequal last_tag.category "epoch"  %}Przeczytaj omówienia z epoki {{ last_tag }} w serwisie Lektury.Gazeta.pl{% endifequal %}
        </a></p>
        {% endif %}
        {% if last_tag.wiki_link %}
        <p><a href="{{ last_tag.wiki_link }}">
            {% ifequal last_tag.category "author" %}Przeczytaj artykuł o autorze w Wikipedii{% endifequal %}
            {% ifequal last_tag.category "epoch"  %}Przeczytaj artykuł o epoce {{ last_tag }} w Wikipedii{% endifequal %}
        </a></p>
        {% endif %}
        <ol>
        {% for book in object_list %}
            <li>
                {% if user_is_owner %}
                    <a href="{% url remove_from_shelf last_tag.slug book.slug %}" class="remove-from-shelf">Usuń</a>
                {% endif %}
                {{ book.short_html }}</li>
        {% endfor %}
        </ol>
        {% endwith %}
        {% paginate %}
    </div>
    <div id="tags-list">
        <div id="categories-list">
            {% if categories.author %}
                <h2>Autorzy</h2>
                {% tag_list categories.author tags %}
            {% endif %}
            {% if categories.kind %}
                <h2>Rodzaje</h2>
                {% tag_list categories.kind tags %}
            {% endif %}
            {% if categories.genre %}
                <h2>Gatunki literackie</h2>
                {% tag_list categories.genre tags %}
            {% endif %}
            {% if categories.epoch %}
                <h2>Epoki</h2>
                {% tag_list categories.epoch tags %}
            {% endif %}        
        </div>
        <div id="themes-list">
            {% if categories.theme %}
                <h2>Motywy</h2>
                {% tag_list categories.theme tags %}
            {% endif %}
        </div>
        <div class="clearboth"></div>
    </div>
    {% endif %}
    <div id="set-window">
        <div class="header"><a href="#" class="jqmClose">Zamknij</a></div>
        <div class="target">
            <p><img src="/static/img/indicator.gif" alt="*"/> Ładowanie</p>
        </div>
    </div>
{% endblock %}